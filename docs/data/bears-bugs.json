[
  {
    "tests": {
      "overallMetrics": {
        "numberPassing": 95, 
        "numberRunning": 96, 
        "numberFailing": 1, 
        "numberErroring": 0, 
        "failures": [
          {
            "failureName": "java.lang.AssertionError", 
            "isError": false, 
            "occurrences": 1
          }
        ], 
        "numberSkipping": 1
      }, 
      "failingModule": "/root/workspace/SpoonLabs/gumtree-spoon-ast-diff/431628140", 
      "failureDetails": [
        {
          "failureName": "java.lang.AssertionError", 
          "testClass": "gumtree.spoon.AstComparatorTest", 
          "testMethod": "test_t_209184_buggy_allopsNPE", 
          "isError": false
        }
      ], 
      "failingClasses": [
        {
          "numberPassing": 79, 
          "numberRunning": 80, 
          "testClass": "gumtree.spoon.AstComparatorTest", 
          "numberFailing": 1, 
          "numberErroring": 0, 
          "numberSkipping": 1
        }
      ]
    }, 
    "builds": {
      "fixerBuild": {
        "url": "http://travis-ci.org/SpoonLabs/gumtree-spoon-ast-diff/builds/431912220", 
        "date": "Sep 22, 2018 6:50:00 PM", 
        "id": 431912220
      }, 
      "buggyBuild": {
        "url": "http://travis-ci.org/SpoonLabs/gumtree-spoon-ast-diff/builds/431628140", 
        "date": "Sep 21, 2018 8:44:35 PM", 
        "id": 431628140
      }
    }, 
    "repository": {
      "name": "SpoonLabs-gumtree-spoon-ast-diff", 
      "url": "https://github.com/SpoonLabs/gumtree-spoon-ast-diff", 
      "isFork": false, 
      "pullRequestId": 0, 
      "isPullRequest": false, 
      "original": {
        "url": "", 
        "name": "", 
        "githubId": 0
      }, 
      "githubId": 25924085
    }, 
    "commits": {
      "fixerBuild": {
        "url": "http://github.com/SpoonLabs/gumtree-spoon-ast-diff/commit/8eaaa2ac48a1bb384aa95b28bf00df444bf421f9", 
        "sha": "8eaaa2ac48a1bb384aa95b28bf00df444bf421f9", 
        "branchName": "master", 
        "date": "Sep 22, 2018 6:46:27 PM", 
        "repoName": "SpoonLabs/gumtree-spoon-ast-diff"
      }, 
      "buggyBuild": {
        "url": "http://github.com/SpoonLabs/gumtree-spoon-ast-diff/commit/820db5860556768256c5fbda3c41c9e62e772c33", 
        "sha": "820db5860556768256c5fbda3c41c9e62e772c33", 
        "branchName": "master", 
        "date": "Sep 21, 2018 8:41:08 PM", 
        "repoName": "SpoonLabs/gumtree-spoon-ast-diff"
      }
    }, 
    "branchUrl": "https://github.com/fermadeiral/test-evolve-bears/tree/SpoonLabs-gumtree-spoon-ast-diff-431628140-431912220", 
    "version": "latest", 
    "patchDiff": {
      "files": {
        "numberAdded": 0, 
        "numberChanged": 1, 
        "numberDeleted": 0
      }, 
      "lines": {
        "numberAdded": 22, 
        "numberDeleted": 23
      }
    }, 
    "type": "passing_passing", 
    "bugId": "Bears_1", 
    "diff": "diff --git a/src/main/java/gumtree/spoon/diff/DiffImpl.java b/src/main/java/gumtree/spoon/diff/DiffImpl.java\nindex c06b882..976e2db 100644\n--- a/src/main/java/gumtree/spoon/diff/DiffImpl.java\n+++ b/src/main/java/gumtree/spoon/diff/DiffImpl.java\n@@ -1,5 +1,12 @@\n package gumtree.spoon.diff;\n \n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.NoSuchElementException;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n import com.github.gumtreediff.actions.ActionGenerator;\n import com.github.gumtreediff.actions.model.Action;\n import com.github.gumtreediff.actions.model.Delete;\n@@ -11,6 +18,7 @@ import com.github.gumtreediff.matchers.MappingStore;\n import com.github.gumtreediff.matchers.Matcher;\n import com.github.gumtreediff.tree.ITree;\n import com.github.gumtreediff.tree.TreeContext;\n+\n import gumtree.spoon.builder.SpoonGumTreeBuilder;\n import gumtree.spoon.diff.operations.DeleteOperation;\n import gumtree.spoon.diff.operations.InsertOperation;\n@@ -20,13 +28,6 @@ import gumtree.spoon.diff.operations.OperationKind;\n import gumtree.spoon.diff.operations.UpdateOperation;\n import spoon.reflect.declaration.CtElement;\n \n-import java.util.ArrayList;\n-import java.util.Collections;\n-import java.util.List;\n-import java.util.NoSuchElementException;\n-import java.util.Optional;\n-import java.util.stream.Collectors;\n-\n /**\n  * @author Matias Martinez, matias.martinez@inria.fr\n  */\n@@ -54,12 +55,17 @@ public class DiffImpl implements Diff {\n \t\tfinal Matcher matcher = new CompositeMatchers.ClassicGumtree(rootSpoonLeft, rootSpoonRight, mappingsComp);\n \t\tmatcher.match();\n \n-\t\tfinal ActionGenerator actionGenerator = new ActionGenerator(rootSpoonLeft, rootSpoonRight, matcher.getMappings());\n+\t\tfinal ActionGenerator actionGenerator = new ActionGenerator(rootSpoonLeft, rootSpoonRight,\n+\t\t\t\tmatcher.getMappings());\n \t\tactionGenerator.generate();\n \n-\n+\t\tActionClassifier actionClassifier = new ActionClassifier(matcher.getMappingsAsSet(),\n+\t\t\t\tactionGenerator.getActions());\n+\t\t// Bugfix: the Action classifier must be executed *BEFORE* the convertToSpoon\n+\t\t// because it writes meta-data on the trees\n+\t\tthis.rootOperations = convertToSpoon(actionClassifier.getRootActions());\n \t\tthis.allOperations = convertToSpoon(actionGenerator.getActions());\n-\t\tthis.rootOperations = convertToSpoon(new ActionClassifier(matcher.getMappingsAsSet(), actionGenerator.getActions()).getRootActions());\n+\n \t\tthis._mappingsComp = mappingsComp;\n \t\tthis.context = context;\n \n@@ -120,7 +126,8 @@ public class DiffImpl implements Diff {\n \t\t\tCtElement el = operation.getNode();\n \t\t\tif (operation instanceof InsertOperation) {\n \t\t\t\t// we take the corresponding node in the source tree\n-\t\t\t\tel = (CtElement) _mappingsComp.getSrc(operation.getAction().getNode().getParent()).getMetadata(SpoonGumTreeBuilder.SPOON_OBJECT);\n+\t\t\t\tel = (CtElement) _mappingsComp.getSrc(operation.getAction().getNode().getParent())\n+\t\t\t\t\t\t.getMetadata(SpoonGumTreeBuilder.SPOON_OBJECT);\n \t\t\t}\n \t\t\tcopy.add(el);\n \t\t}\n@@ -170,11 +177,12 @@ public class DiffImpl implements Diff {\n \t}\n \n \t@Override\n-\tpublic boolean containsOperations(List<Operation> operations, OperationKind kind, String nodeKind, String nodeLabel) {\n-\t\treturn operations.stream().anyMatch(operation -> operation.getAction().getClass().getSimpleName().equals(kind.name()) //\n-\t\t\t\t&& context.getTypeLabel(operation.getAction().getNode()).equals(nodeKind)\n-\t\t\t\t&& operation.getAction().getNode().getLabel().equals(nodeLabel)\n-\t\t);\n+\tpublic boolean containsOperations(List<Operation> operations, OperationKind kind, String nodeKind,\n+\t\t\tString nodeLabel) {\n+\t\treturn operations.stream()\n+\t\t\t\t.anyMatch(operation -> operation.getAction().getClass().getSimpleName().equals(kind.name()) //\n+\t\t\t\t\t\t&& context.getTypeLabel(operation.getAction().getNode()).equals(nodeKind)\n+\t\t\t\t\t\t&& operation.getAction().getNode().getLabel().equals(nodeLabel));\n \t}\n \n \t@Override\n@@ -193,9 +201,10 @@ public class DiffImpl implements Diff {\n \t\t\t}\n \t\t\tString nodeType = context.getTypeLabel(node.getType());\n \t\t\tif (nodeElement != null) {\n-\t\t\t\tnodeType += \"(\" + nodeElement.getClass().getSimpleName()+\")\";\n+\t\t\t\tnodeType += \"(\" + nodeElement.getClass().getSimpleName() + \")\";\n \t\t\t}\n-\t\t\tresult += \"\\\"\" + operation.getAction().getClass().getSimpleName() + \"\\\", \\\"\" + nodeType + \"\\\", \" + label + \" (size: \" + node.getDescendants().size() + \")\" + node.toTreeString();\n+\t\t\tresult += \"\\\"\" + operation.getAction().getClass().getSimpleName() + \"\\\", \\\"\" + nodeType + \"\\\", \" + label\n+\t\t\t\t\t+ \" (size: \" + node.getDescendants().size() + \")\" + node.toTreeString();\n \t\t}\n \t\treturn result;\n \t}\n", 
    "projectMetrics": {
      "numberSourceFiles": 15, 
      "numberLibrariesFailingModule": 40, 
      "numberTestFiles": 3, 
      "numberModules": 1
    }, 
    "reproductionBuggyBuild": {
      "machineInfo": {
        "freeMemory": 50680392, 
        "hostName": "59c36aec69f2", 
        "totalMemory": 113246208, 
        "numberCPU": 4
      }, 
      "reproductionDateEnd": "Oct 15, 2018 12:10:23 AM", 
      "projectRootPomPath": "./workspace/SpoonLabs/gumtree-spoon-ast-diff/431628140/pom.xml", 
      "processDurations": {
        "building": {
          "stepDurations": [
            0, 
            3, 
            0, 
            0, 
            335
          ], 
          "stepNames": [
            "CheckoutPatchedBuildCandidate", 
            "ComputeSourceDir", 
            "ComputeTestDir", 
            "CheckoutBuggyBuildCandidateSourceCode", 
            "BuildProjectBuggyBuildCandidateSourceCode"
          ], 
          "nbSteps": 5, 
          "totalDuration": 338
        }, 
        "testing": {
          "stepDurations": [
            212
          ], 
          "stepNames": [
            "TestProjectBuggyBuildCandidateSourceCode"
          ], 
          "nbSteps": 1, 
          "totalDuration": 212
        }, 
        "cloning": {
          "stepDurations": [
            23
          ], 
          "stepNames": [
            "CloneRepository"
          ], 
          "nbSteps": 1, 
          "totalDuration": 23
        }
      }, 
      "reproductionDateBeginning": "Oct 14, 2018 11:56:32 PM", 
      "totalDuration": 818
    }
  }
]